@using Modulus.UI.Abstractions

<MudDrawer @bind-Open="IsOpen" 
           ClipMode="DrawerClipMode.Always" 
           Elevation="2" 
           Variant="@(IsMini ? DrawerVariant.Mini : DrawerVariant.Responsive)"
           MiniWidth="56px"
           Width="220px"
           Breakpoint="Breakpoint.Md">
    <div class="drawer-content">
        <!-- Top Section: Header + Main Menu -->
        <div class="drawer-top">
            @if (!IsMini || IsOpen)
            {
                <MudDrawerHeader>
                    <MudText Typo="Typo.h6">@HeaderTitle</MudText>
                </MudDrawerHeader>
            }
            @if (ShowHome)
            {
                <MudNavMenu Bordered="true" Color="Color.Primary">
                    <MudTooltip Text="Home" Placement="Placement.Right" Disabled="@(!IsMini || IsOpen)">
                        <MudNavLink Href="/" Icon="@Icons.Material.Filled.Home" Match="NavLinkMatch.All">
                            @if (!IsMini || IsOpen)
                            {
                                <span>Home</span>
                            }
                        </MudNavLink>
                    </MudTooltip>
                </MudNavMenu>
            }
            <NavigationMenu Items="MainItems" IsMini="@(IsMini && !IsOpen)" OnItemClicked="OnItemClicked" />
        </div>
        
        <!-- Bottom Section: Bottom Menu Items -->
        <div class="drawer-bottom">
            @if (!IsMini || IsOpen)
            {
                <MudDivider Class="mb-2" />
            }
            <NavigationMenu Items="BottomItems" IsMini="@(IsMini && !IsOpen)" OnItemClicked="OnItemClicked" />
        </div>
    </div>
</MudDrawer>

<style>
    .drawer-content {
        display: flex;
        flex-direction: column;
        height: 100%;
    }
    
    .drawer-top {
        flex: 1;
        overflow-y: auto;
    }
    
    .drawer-bottom {
        flex-shrink: 0;
        padding-bottom: 8px;
    }
</style>

@code {
    [Parameter]
    public bool IsOpen { get; set; } = true;

    [Parameter]
    public EventCallback<bool> IsOpenChanged { get; set; }

    /// <summary>
    /// When true, drawer uses Mini variant (icon-only when closed).
    /// </summary>
    [Parameter]
    public bool IsMini { get; set; } = true;

    /// <summary>
    /// Header title displayed when drawer is open.
    /// </summary>
    [Parameter]
    public string HeaderTitle { get; set; } = "Navigation";

    /// <summary>
    /// Whether to show the Home link.
    /// </summary>
    [Parameter]
    public bool ShowHome { get; set; } = true;

    /// <summary>
    /// Main menu items (top section).
    /// </summary>
    [Parameter]
    public IEnumerable<MenuItem> MainItems { get; set; } = Enumerable.Empty<MenuItem>();

    /// <summary>
    /// Bottom menu items.
    /// </summary>
    [Parameter]
    public IEnumerable<MenuItem> BottomItems { get; set; } = Enumerable.Empty<MenuItem>();

    /// <summary>
    /// Callback when a menu item is clicked.
    /// </summary>
    [Parameter]
    public EventCallback<MenuItem> OnItemClicked { get; set; }
}

