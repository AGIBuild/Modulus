# Modulus

Modulus is a modern, cross-platform, plugin-based application framework designed to help developers quickly build extensible, maintainable, and AI-ready tools.

## ğŸ–¼ï¸ Screenshots

### Home (Light)
![Home (Light)](./docs/Images/home-light.jpg)

### Home (Dark)
![Home (Dark)](./docs/Images/home-dark.jpg) 


## âœ¨ Features

### Multi-Host Architecture
- **UI-Agnostic Core**: Business logic independent of any UI framework
- **Pluggable Hosts**: Supports Avalonia (desktop) and Blazor Hybrid (MAUI)
- **Shared Core Logic**: Same Domain/Application code runs across all hosts

### Extension System
- **VS Extension Compatible**: Uses `extension.vsixmanifest` (XML) format
- **Hot-Reloadable**: AssemblyLoadContext-based isolation for dynamic load/unload
- **Explicit Installation**: Extensions installed via CLI or UI, not auto-discovered
- **Type-Safe Entry Points**: `ModulusPackage` base class similar to VS VsPackage

### Developer Experience
- Extension SDK with declarative attributes
- AI Agent plugin support (LLM integration)
- Signature verification and version control
- Cross-platform: Windows / macOS / Linux

## ğŸ—ï¸ Architecture

```
src/
â”œâ”€â”€ Modulus.Core/              # Runtime, module loader, DI
â”œâ”€â”€ Modulus.Sdk/               # SDK: ModulusPackage, attributes
â”œâ”€â”€ Modulus.UI.Abstractions/   # UI contracts (IMenuRegistry, INavigationService)
â”œâ”€â”€ Hosts/
â”‚   â”œâ”€â”€ Modulus.Host.Avalonia/ # Avalonia desktop (ID: Modulus.Host.Avalonia)
â”‚   â””â”€â”€ Modulus.Host.Blazor/   # Blazor Hybrid (ID: Modulus.Host.Blazor)
â””â”€â”€ Modules/
    â”œâ”€â”€ EchoPlugin/            # Example: Echo plugin
    â”œâ”€â”€ SimpleNotes/           # Example: Notes module
    â””â”€â”€ ComponentsDemo/        # Example: UI components demo
```

## ğŸ“¦ Extension Structure

```
MyExtension/
â”œâ”€â”€ extension.vsixmanifest     # XML manifest (VS Extension format)
â”œâ”€â”€ MyExtension.Core.dll       # Core logic (host-agnostic)
â”œâ”€â”€ MyExtension.UI.Avalonia.dll
â””â”€â”€ MyExtension.UI.Blazor.dll
```

## ğŸš€ Quick Start

### Install CLI and Templates

```bash
# Install the Modulus CLI
dotnet tool install -g Agibuild.Modulus.Cli

# Install project templates
dotnet new install Agibuild.Modulus.Templates
```

### Create Your First Module

```bash
# Create a new module
modulus new MyModule -t avalonia

# Or use dotnet new
dotnet new modulus-avalonia -n MyModule

# Navigate to module directory
cd MyModule

# Build the module
modulus build

# Package for distribution
modulus pack

# Install to test
modulus install ./output/MyModule-1.0.0.modpkg
```

### Run the Host

```bash
# Run Avalonia Host
dotnet run --project src/Hosts/Modulus.Host.Avalonia

# Run Blazor Host (Windows only)
dotnet run --project src/Hosts/Modulus.Host.Blazor
```

## ğŸ› ï¸ CLI Tool

Modulus provides a comprehensive command-line tool for module development and management.

### Commands

| Command | Description |
|---------|-------------|
| `modulus new <name>` | Create a new module project |
| `modulus build` | Build the module in current directory |
| `modulus pack` | Build and package as .modpkg |
| `modulus install <source>` | Install a module |
| `modulus uninstall <name>` | Uninstall a module |
| `modulus list` | List installed modules |

### Create Module

```bash
modulus new MyModule [options]

Options:
  -t, --target <avalonia|blazor>  Target host platform
  -d, --display-name <name>       Display name in menus
  -p, --publisher <name>          Publisher name
  -i, --icon <icon>               Menu icon
  --force                         Overwrite existing
```

### Build and Package

```bash
# Build the module
modulus build

# Package for distribution
modulus pack

# Package options
modulus pack -o ./dist --verbose
```

### Install and Manage

```bash
# Install from .modpkg file
modulus install ./MyModule-1.0.0.modpkg

# Install from directory (development)
modulus install ./artifacts/bin/Modules/MyModule/

# Force overwrite existing installation
modulus install ./MyModule-1.0.0.modpkg --force

# Uninstall
modulus uninstall MyModule

# List installed modules
modulus list --verbose
```

## ğŸ”Œ Creating an Extension

### 1. Create Projects

```bash
modulus new MyExtension -t avalonia
```

This creates:
```
MyExtension/
â”œâ”€â”€ MyExtension.sln
â”œâ”€â”€ extension.vsixmanifest
â”œâ”€â”€ MyExtension.Core/
â”‚   â”œâ”€â”€ MyExtensionModule.cs
â”‚   â””â”€â”€ ViewModels/MainViewModel.cs
â””â”€â”€ MyExtension.UI.Avalonia/
    â”œâ”€â”€ MyExtensionAvaloniaModule.cs
    â””â”€â”€ MainView.axaml
```

### 2. Define Entry Point

```csharp
// MyExtension.Core/MyExtensionModule.cs
public class MyExtensionModule : ModulusPackage
{
    public override void ConfigureServices(IModuleLifecycleContext context)
    {
        context.Services.AddSingleton<IMyService, MyService>();
        context.Services.AddTransient<MainViewModel>();
    }
}
```

### 3. Create Manifest

The manifest is auto-generated by templates. Key sections:

```xml
<!-- extension.vsixmanifest -->
<?xml version="1.0" encoding="utf-8"?>
<PackageManifest Version="2.0.0" 
    xmlns="http://schemas.microsoft.com/developer/vsx-schema/2011">
  <Metadata>
    <Identity Id="your-guid" Version="1.0.0" Publisher="You" />
    <DisplayName>My Extension</DisplayName>
    <Description>My awesome extension</Description>
  </Metadata>
  <Installation>
    <InstallationTarget Id="Modulus.Host.Avalonia" Version="[1.0,)" />
    <InstallationTarget Id="Modulus.Host.Blazor" Version="[1.0,)" />
  </Installation>
  <Assets>
    <Asset Type="Modulus.Package" Path="MyExtension.Core.dll" />
    <Asset Type="Modulus.Package" Path="MyExtension.UI.Avalonia.dll" 
           TargetHost="Modulus.Host.Avalonia" />
    <!-- Menus are NOT declared in the manifest.
         Declare menus via [AvaloniaMenu]/[BlazorMenu] on the host-specific module entry type
         and project them to the database at install/update time (metadata-only). -->
  </Assets>
</PackageManifest>
```

### 4. Build, Package, and Install

```bash
cd MyExtension
modulus build
modulus pack
modulus install ./output/MyExtension-1.0.0.modpkg
```

## ğŸ“š Documentation

- [Getting Started Guide](./docs/getting-started.md)
- [CLI Reference](./docs/cli-reference.md)
- [Module Development Guide](./docs/module-development.md)
- [OpenSpec Specifications](./openspec/specs/)
- [Contributing Guide](./CONTRIBUTING.md)

## ğŸ­ Build System

The project uses Nuke for build automation:

```bash
# Build all
nuke compile

# Run tests
nuke test

# Package modules
nuke pack-module

# Package CLI templates
nuke pack-templates

# Publish NuGet packages
nuke publish-libs
```

## Project Status

- **Phase**: Active Development
- **Test Coverage**: 30+ tests passing
- **Platforms**: Windows, macOS, Linux

## NuGet Packages

| Package | Description |
|---------|-------------|
| `Agibuild.Modulus.Sdk` | SDK for module development |
| `Agibuild.Modulus.UI.Abstractions` | UI contracts and abstractions |
| `Agibuild.Modulus.UI.Avalonia` | Avalonia UI components |
| `Agibuild.Modulus.UI.Blazor` | Blazor UI components |
| `Agibuild.Modulus.Cli` | CLI tool |
| `Agibuild.Modulus.Templates` | Project templates |

> Note: `modulus new` generates a `Directory.Build.props` with `ModulusCliLibDir` so newly generated modules can compile against the same Modulus assemblies shipped with the CLI.

## Contributing

Pull requests and issues are welcome! See [CONTRIBUTING.md](./CONTRIBUTING.md) for guidelines.

## License

[MIT License](./LICENSE)
